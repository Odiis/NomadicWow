/*
-- Query: select * from smart_scripts where entryorguid=9543
LIMIT 0, 1000
-- Lower Blackrock Depths prepare. Roger
-- Date: 2016-02-03 20:27
*/

-- supports quests 27571 and 27589. Ribbly Screwspigot event.

DELETE FROM `smart_scripts` WHERE `entryorguid` IN (9543,10043) AND `source_type`=0;
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (9543,0,0,0,0,0,100,2,4000,4000,12000,12000,11,12540,0,0,0,0,0,5,0,0,0,0,0,0,0,'Cast Gouge');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (9543,0,1,0,0,0,100,2,5000,6000,10000,14000,11,9080,0,0,0,0,0,5,0,0,0,0,0,0,0,'Cast Hamstring');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (9543,0,2,3,62,0,100,2,1970,0,0,0,72,0,0,0,0,0,0,7,0,0,0,0,0,0,0,'On gossip select close gossip.');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (9543,0,3,4,61,0,100,2,0,0,0,0,2,736,0,0,0,0,0,1,0,0,0,0,0,0,0,'smart link to previous event set hostile faction.');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (9543,0,4,5,61,0,100,2,0,0,0,0,45,1,1,0,0,0,0,11,10043,100,0,0,0,0,0,'smart link to previous event set data on cronys.');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (9543,0,5,6,61,0,100,2,0,0,0,0,49,0,0,0,0,0,0,7,0,0,0,0,0,0,0,'Ribbly Screwspigot - Linked with Previous Event - Attack Invoker');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (9543,0,6,0,61,0,100,2,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,'smart link - say line one');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (9543,0,7,0,25,0,100,2,0,0,0,0,2,735,0,0,0,0,0,1,0,0,0,0,0,0,0,'on reset set default faction');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (10043,0,0,0,25,0,100,0,0,0,0,0,2,735,0,0,0,0,0,1,0,0,0,0,0,0,0,'Ribblys Crony - On Reset - Set Default Faction');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (10043,0,1,2,38,0,100,0,1,1,0,0,2,736,0,0,0,0,0,1,0,0,0,0,0,0,0,'Ribblys Crony - On Data Set 1 1 - Set Hostile');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (10043,0,2,0,61,0,100,0,0,0,0,0,49,0,0,0,0,0,0,18,40,0,0,0,0,0,0,'Ribblys Crony - Linked with Previous Event - Attack');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (10043,0,3,0,0,0,100,0,5000,14000,5000,14000,11,15692,2,0,0,0,0,2,0,0,0,0,0,0,0,'Ribblys Crony - IC - Cast Eviscerate');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (10043,0,4,0,0,0,100,0,2000,11000,2000,11000,11,15581,0,0,0,0,0,2,0,0,0,0,0,0,0,'Ribblys Crony - IC - Cast Sinister Strike');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (10043,0,5,0,0,0,100,0,8000,18000,8000,18000,11,13298,0,0,0,0,0,2,32,0,0,0,0,0,0,'Ribblys Crony - IC - Cast Poison');

-- Fix Shadowforge Lock Mechanism.
DELETE FROM `gameobject` WHERE `id` IN (161461,157923,161462,161516);
INSERT INTO `gameobject` (`guid`,`id`,`map`,`spawnMask`,`phaseMask`,`position_x`,`position_y`,`position_z`,`orientation`,`rotation0`,`rotation1`,`rotation2`,`rotation3`,`spawntimesecs`,`animprogress`,`state`) VALUES (188511,157923,230,1,1,723.106,-105.874,-71.4839,2.3562,0,0,0.92388,0.382683,7200,255,0);
INSERT INTO `gameobject` (`guid`,`id`,`map`,`spawnMask`,`phaseMask`,`position_x`,`position_y`,`position_z`,`orientation`,`rotation0`,`rotation1`,`rotation2`,`rotation3`,`spawntimesecs`,`animprogress`,`state`) VALUES (188289,161461,230,1,1,614.021,-46.8877,-59.636,-2.63544,0,0,-0.968147,0.250381,7200,255,1);
INSERT INTO `gameobject` (`guid`,`id`,`map`,`spawnMask`,`phaseMask`,`position_x`,`position_y`,`position_z`,`orientation`,`rotation0`,`rotation1`,`rotation2`,`rotation3`,`spawntimesecs`,`animprogress`,`state`) VALUES (188389,161462,230,1,1,723.114,-105.856,-71.4763,2.3562,0,0,0.92388,0.382683,7200,255,0);
INSERT INTO `gameobject` (`guid`,`id`,`map`,`spawnMask`,`phaseMask`,`position_x`,`position_y`,`position_z`,`orientation`,`rotation0`,`rotation1`,`rotation2`,`rotation3`,`spawntimesecs`,`animprogress`,`state`) VALUES (188402,161516,230,1,1,702.107,-125.745,-45.7122,-2.3562,0,0,-0.92388,0.382683,7200,255,0);

DELETE FROM `smart_scripts` WHERE `entryorguid` =161460 AND `source_type`=1;
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (161460,1,0,1,70,0,100,0,2,0,0,0,9,0,0,0,0,0,0,14,188289,161461,0,0,0,0,0,'Shadowforge Lock - On Activate - Open the Giant Door Mechanism');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (161460,1,1,2,61,0,100,0,0,0,0,0,9,0,0,0,0,0,0,14,188511,157923,0,0,0,0,0,'Shadowforge Lock - On Activate - Close the Giant Doors');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (161460,1,2,3,61,0,100,0,0,0,0,0,9,0,0,0,0,0,0,14,188389,161462,0,0,0,0,0,'Shadowforge Lock - On Activate - Remove the great invisible wall');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (161460,1,3,0,61,0,100,0,0,0,0,0,9,0,0,0,0,0,0,14,188389,161516,0,0,0,0,0,'Shadowforge Lock - On Activate - Remove the invisible wall on top');

-- support Private Roknut script. his quest must be repeatable and done 4 times for script to start.
UPDATE `quest_template` SET `flags`=8192,`SpecialFlags`=1 WHERE `id`=4295;

-- relic coffer and phat lootz.
UPDATE `gameobject_template` SET `data0`=93,`data1`=160836 where `entry`=160836;

delete from gameobject_loot_template where entry=160836 and item in (11937, 11938, 11939, 11940, 11941, 11942, 11943, 11944, 11945, 11946, 11966);
INSERT INTO `gameobject_loot_template` (`Entry`,`Item`,`Reference`,`Chance`,`QuestRequired`,`LootMode`,`GroupId`,`MinCount`,`MaxCount`,`Comment`) VALUES (160836,11937,0,9,0,1,0,1,1,NULL);
INSERT INTO `gameobject_loot_template` (`Entry`,`Item`,`Reference`,`Chance`,`QuestRequired`,`LootMode`,`GroupId`,`MinCount`,`MaxCount`,`Comment`) VALUES (160836,11938,0,9,0,1,0,1,1,NULL);
INSERT INTO `gameobject_loot_template` (`Entry`,`Item`,`Reference`,`Chance`,`QuestRequired`,`LootMode`,`GroupId`,`MinCount`,`MaxCount`,`Comment`) VALUES (160836,11939,0,64,0,1,0,1,1,NULL);
INSERT INTO `gameobject_loot_template` (`Entry`,`Item`,`Reference`,`Chance`,`QuestRequired`,`LootMode`,`GroupId`,`MinCount`,`MaxCount`,`Comment`) VALUES (160836,11940,0,64,0,1,0,1,1,NULL);
INSERT INTO `gameobject_loot_template` (`Entry`,`Item`,`Reference`,`Chance`,`QuestRequired`,`LootMode`,`GroupId`,`MinCount`,`MaxCount`,`Comment`) VALUES (160836,11941,0,27,0,1,0,1,1,NULL);
INSERT INTO `gameobject_loot_template` (`Entry`,`Item`,`Reference`,`Chance`,`QuestRequired`,`LootMode`,`GroupId`,`MinCount`,`MaxCount`,`Comment`) VALUES (160836,11942,0,18,0,1,0,1,1,NULL);
INSERT INTO `gameobject_loot_template` (`Entry`,`Item`,`Reference`,`Chance`,`QuestRequired`,`LootMode`,`GroupId`,`MinCount`,`MaxCount`,`Comment`) VALUES (160836,11943,0,0.9,0,1,0,1,1,NULL);
INSERT INTO `gameobject_loot_template` (`Entry`,`Item`,`Reference`,`Chance`,`QuestRequired`,`LootMode`,`GroupId`,`MinCount`,`MaxCount`,`Comment`) VALUES (160836,11944,0,5,0,1,0,1,1,NULL);
INSERT INTO `gameobject_loot_template` (`Entry`,`Item`,`Reference`,`Chance`,`QuestRequired`,`LootMode`,`GroupId`,`MinCount`,`MaxCount`,`Comment`) VALUES (160836,11945,0,0.5,0,1,0,1,1,NULL);
INSERT INTO `gameobject_loot_template` (`Entry`,`Item`,`Reference`,`Chance`,`QuestRequired`,`LootMode`,`GroupId`,`MinCount`,`MaxCount`,`Comment`) VALUES (160836,11946,0,0.5,0,1,0,1,1,NULL);
INSERT INTO `gameobject_loot_template` (`Entry`,`Item`,`Reference`,`Chance`,`QuestRequired`,`LootMode`,`GroupId`,`MinCount`,`MaxCount`,`Comment`) VALUES (160836,11966,0,79,0,1,0,1,1,NULL);

-- grim guzzler objects.
UPDATE `gameobject_template` SET `data0`=93,`data1`=165739 where `entry`=165739;
UPDATE `gameobject_template` SET `data0`=93,`data1`=165738 where `entry`=165738;
delete from gameobject_loot_template where entry=165738 and item=11325;
INSERT INTO `gameobject_loot_template` (`Entry`,`Item`,`Reference`,`Chance`,`QuestRequired`,`LootMode`,`GroupId`,`MinCount`,`MaxCount`,`Comment`) VALUES (165738,11325,0,100,0,1,0,1,1,NULL);
delete from gameobject_loot_template where entry=165739 and item=11444;
INSERT INTO `gameobject_loot_template` (`Entry`,`Item`,`Reference`,`Chance`,`QuestRequired`,`LootMode`,`GroupId`,`MinCount`,`MaxCount`,`Comment`) VALUES (165739,11444,0,100,0,1,0,1,3,NULL);

-- mole machine transports
UPDATE `gameobject_template` SET `AIName`='SmartGameObjectAI' WHERE `entry` IN (207403,207401,207402);
UPDATE gossip_menu_option SET `option_id`=1,`npc_option_npcflag`=1 WHERE menu_id IN(12549,12550,12551);
-- port co-ords ti come later.

-- entering the throne room requires lighting braziers then script opens doors.
UPDATE `creature_loot_template` SET `Chance`=100,`QuestRequired`=0 WHERE `item`=11885;
UPDATE `gameobject` SET `state`=1 WHERE id IN(174744,174745);-- brazier must spawn closed for torch to work.
UPDATE `item_template` SET `class`=0  WHERE `entry`=11885;


delete from smart_scripts where entryorguid in (207401, 207402, 207403);
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (207401,1,0,0,62,0,100,0,12549,0,0,0,62,230,0,0,0,0,0,7,0,0,0,933.297,-290.39,-49.939,1.16937,'guzzler port.');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (207401,1,1,0,62,0,100,0,12549,1,0,0,62,230,0,0,0,0,0,7,0,0,0,804.866,-247.181,-43.3032,-1.0472,'domicile port');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (207402,1,0,0,62,0,100,0,12550,0,0,0,62,230,0,0,0,0,0,7,0,0,0,444.795,21.6985,-70.6062,-1.0472,'entrance port');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (207402,1,1,0,62,0,100,0,12550,1,0,0,62,230,0,0,0,0,0,7,0,0,0,804.866,-247.181,-43.3032,-1.0472,'domicile port');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (207403,1,0,0,62,0,100,0,12551,0,0,0,62,230,0,0,0,0,0,7,0,0,0,444.795,21.6985,-70.6062,-1.0472,'entrance port');
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES (207403,1,1,0,62,0,100,0,12551,1,0,0,62,230,0,0,0,0,0,7,0,0,0,933.297,-290.39,-49.939,1.16937,'guzzler port');



